{
    "name": "base",
    "image":"ghcr.io/lucanori/coder-templates:latest",
    "customizations": {
        "vscode": {
            "extensions": [
                "hamza-aziane.obsidian-dark",
                "aquasecurityofficial.trivy-vulnerability-scanner",
                "esbenp.prettier-vscode",
                "redhat.vscode-yaml",
                "davidanson.vscode-markdownlint",
                "mads-hartmann.bash-ide-vscode",
                "eamodio.gitlens"
            ],
            "settings": {
                "workbench.colorTheme": "Obsidian Dark",
                "files.autoSave": "afterDelay",
                "workbench.startupEditor": "none",
                "workbench.tips.enabled": false,
                "workbench.editor.enablePreview": false,
                "ansible.python.interpreterPath": "/nix/var/nix/profiles/default/bin/python3",
                "git.autofetch": true,
                "git.confirmSync": false,
                "git.autoStash": true,
                "git.enableSmartCommit": true,
                "git.fetchOnPull": true,
                "git.pullBeforeCheckout": true,
                "git.rebaseWhenSync": true,
                "search.exclude": {
                    "**/.cache": true,
                    "**/.git": true,
                    "**/*.code-search": false,
                    "**/build": true,
                    "**/coverage": true,
                    "**/dist": true,
                    "**/venv": true,
                    "**/.venv": true,
                    "**/node_modules": true,
                    "**/vendor": true
                }
            }
        }
    },
    "mounts": [
        "source=/var/run/docker.sock,target=/var/run/docker.sock,type=bind"
    ],
    "containerEnv": {
      "OPENROUTER_KEY": "${localEnv:OPENROUTER_KEY}",
      "FIGMA_TOKEN": "${localEnv:FIGMA_TOKEN}",
      "OPENCODE_KEY": "${localEnv:OPENCODE_KEY}"
    },
    "postStartCommand": [
      "bash",
      "-lc",
      "set -euo pipefail; umask 077; mkdir -p /home/coder/.config/opencode/.secrets /home/coder/.local/share/opencode; OPENROUTER_VAL=${OPENROUTER_KEY:-}; FIGMA_VAL=${FIGMA_TOKEN:-}; OPENCODE_VAL=${OPENCODE_KEY:-}; printf '%s' \"$OPENROUTER_VAL\" > /home/coder/.config/opencode/.secrets/openrouter-key; printf '%s' \"$FIGMA_VAL\" > /home/coder/.config/opencode/.secrets/figma-token; printf '{\\n  \\\"opencode\\\": {\\n    \\\"type\\\": \\\"api\\\",\\n    \\\"key\\\": \\\"%s\\\"\\n  }\\n}\\n' \"$OPENCODE_VAL\" > /home/coder/.local/share/opencode/auth.json; [ -z \"$OPENROUTER_VAL\" ] && echo 'warning: OPENROUTER_KEY missing' >&2; [ -z \"$FIGMA_VAL\" ] && echo 'warning: FIGMA_TOKEN missing' >&2; [ -z \"$OPENCODE_VAL\" ] && echo 'warning: OPENCODE_KEY missing' >&2"
    ],
    "remoteUser": "coder"
}
